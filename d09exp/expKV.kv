#:kivy 1.11.1
#: import ism kivy.uix.screenmanager

WindowManager:
    id: sm
    transition: ism.NoTransition()
    current: "main"
    MainScreen:
    ParticipantScreen:
    PersonalityScreen:
    StimuliScreen:
    ExitScreen:

<Button>:
    background_color: 0.5,0.25,1,0.3
    color: 1,1,1,1

<ToggleButton>:
    background_color: 0.5,0.25,1,0.3
    color: 1,1,1,1

<NavBar>:
    btCtrl: btCtrl
    size_hint: 1.0, 0.1
    cols: 5
    Button:
        id: btCtrl
        disabled: True
        text: "Main Page"
        on_release:
            app.root.current = "main"
    Button:
        id: btCtrl
        disabled: True
        text: "Participant"
        on_release:
            app.root.current = "participant"
    Button:
        id: btCtrl
        disabled: True
        text: "Personality"
        on_release:
            app.root.current = "personality"
    Button:
        id: btCtrl
        disabled: True
        text: "Stimuli"
        on_release:
            app.root.current = "stimuli"
    Button:
        id: btCtrl
        disabled: False
        text: "Exit"
        on_release:
            app.root.current = "exit"

<MainScreen>:
    name: "main"
    parNum: parNum
    Image:
        source: "./resources/img/wallM.png"
        keep_ratio: False
        allow_stretch: True
        size_hint: (None, None)
        size: (self.parent.width, self.parent.height)
    FloatLayout:
        GridLayout:
            cols: 1
            size_hint: 0.4, 0.4
            pos_hint: {"x":0.3, "top":0.7}
            Label:
                text: "Welcome to  the study nnn"
            Label:
                text: "Please confirm participant number"
            TextInput:
                id: parNum
                text: root.get()
                multiline: False
                input_filter: "int"
                halign: "center"
            Button:
                text: "Start Experiment"
                on_release:
                    root.set()
                    app.root.current = "participant"
        NavBar:

<ParticipantScreen>:
    name: "participant"
    parQuestion: parQuestion
    parBtn1: parBtn1
    parBtn2: parBtn2
    grid1: grid1
    Image:
        source: "./resources/img/wallM.png"
        keep_ratio: False
        allow_stretch: True
        size_hint: (None, None)
        size: (self.parent.width, self.parent.height)
    FloatLayout:
        GridLayout:
            cols: 1
            size_hint: 0.4, 0.4
            pos_hint: {"x":0.3, "top":0.7}
            Label:
                text: "Please answer the following questions as accurately as you can."
            Label:
                id: parQuestion
                text: "Click [Next question] to start"
            GridLayout:
                id: grid1
            Button:
                id: parBtn1
                text: "Next question"
                on_release:
                    root.submit()
                    root.get_q()
            Button:
                id: parBtn2
                text: "Continue study"
                disabled: True
                on_release:
                    app.root.current = "personality"
        NavBar:

<PersonalityScreen>:
    name: "personality"
    perQuestion: perQuestion
    perBtn1: perBtn1
    perBtn2: perBtn2
    grid2: grid2
    Image:
        source: "./resources/img/wallM.png"
        keep_ratio: False
        allow_stretch: True
        size_hint: (None, None)
        size: (self.parent.width, self.parent.height)
    FloatLayout:
        GridLayout:
            cols: 1
            size_hint: 0.4, 0.5
            pos_hint: {"x":0.3, "top":0.7}
            Label:
                size: self.texture_size
                text_size: cm(14), cm(3.5)
                text:
                    "How I am in general?\nHere are a number of characteristics \
                    that may or may not apply to you. For example, do you agree \
                    that you are someone who likes to spend time with others? \
                    Please select the number below each statement to indicate the \
                    extent to which you agree or disagree with that statement.\n\nI \
                    am someone who..."
            Label:
                id: perQuestion
                text: "Click [Next question] to start"
            GridLayout:
                id: grid2
            Button:
                id: perBtn1
                text: "Next question"
                on_release:
                    root.submit()
                    root.get_q()
            Button:
                id: perBtn2
                text: "Continue study"
                disabled: True
                on_release:
                    app.root.current = "stimuli"
        NavBar:

<StimuliScreen>:
    name: "stimuli"
    slider: slider
    plyBtn: plyBtn
    nxtBtn: nxtBtn
    contBtn: contBtn

    Image:
        source: "./resources/img/wallM.png"
        keep_ratio: False
        allow_stretch: True
        size_hint: (None, None)
        size: (self.parent.width, self.parent.height)
    FloatLayout:
        GridLayout:
            cols: 1
            size_hint: 0.4, 0.4
            pos_hint: {"x":0.3, "top":0.7}
            Label:
                text:
                    "Listen to the following musical pieces.\n \
                    When the music has finished playing, indicate \
                    your liking of the piece by moving the slider."
            Label:
                text: "Click [Play] to listen"
            Button:
                id: plyBtn
                text: "Play"
                disabled: True
                on_release:
                    root.play_stimulus()
            Slider:
                id: slider
                min: 0
                max: 100
                value: 50
                size_hint_x: 100
                disabled: True
            GridLayout:
                cols: 3
                Label:
                    halign: "left"
                    valign: "top"
                    text_size: self.size
                    text: "Dislike"
                Label:
                    halign: "center"
                    valign: "top"
                    text_size: self.size
                    text: "Neutral"
                Label:
                    halign: "right"
                    valign: "top"
                    text_size: self.size
                    text: "Like"
            Label:
                id: sl1
                halign: "center"
                text: str("%.1f" % slider.value)
            Button:
                id: nxtBtn
                text: "Next"
                on_release:
                    root.submit()
                    root.get_s()
            Button:
                id: contBtn
                text: "Continue study"
                disabled: True
                on_release:
                    app.root.current = "exit"

        NavBar:

<ExitScreen>:
    name: "exit"
    Image:
        source: "./resources/img/wallM.png"
        keep_ratio: False
        allow_stretch: True
        size_hint: (None, None)
        size: (self.parent.width, self.parent.height)
    FloatLayout:
        GridLayout:
            cols: 1
            size_hint: 0.4, 0.4
            pos_hint: {"x":0.3, "top":0.7}
            Label:
                text: "The study is complete!"
            Label:
                text: "Thank you for your participation."
            Label:
                text: "Please see the ..."
            Button:
                #size_hint: 0.2, 0.2
                text: "Click to Exit"
                on_release:
                    app.stop()
        NavBar:
